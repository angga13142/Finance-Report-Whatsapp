echo "ğŸ” Running pre-commit checks..."

# Run lint-staged to format and lint staged files
echo "ğŸ“ Formatting and linting staged files..."
npx lint-staged || {
  echo "âŒ Lint-staged failed. Please fix the issues above."
  exit 1
}

# Run type checking on staged TypeScript files
# Only check files that are staged and are TypeScript files
echo "ğŸ”§ Type checking staged TypeScript files..."
staged_ts_files=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$' || true)
if [ -n "$staged_ts_files" ]; then
  echo "$staged_ts_files" | xargs npx tsc --noEmit --skipLibCheck || {
    echo "âŒ Type check failed. Please fix TypeScript errors before committing."
    exit 1
  }
fi

echo "âœ… Pre-commit checks passed!"
